# 概念

+ 信号特性：1. 简单。2.不能携带大量信息。3.满足某个特点条件才能发送
+ 信号机制：A给B发送信号，B收到信号之前执行自己的代码，**当收到信号之后，不管执行到程序什么位置，都要暂停运行，去处理信号，处理完成再跳到暂停的位置继续执行**。与硬件中断类似。
+ 信号是软件层面上实现的中断，早期也被叫做软中断
+ 信号的特质：由于信号是通过软件方式实现的，其实现手段导致信号有很强的延时性，但是对于用户来说，这延时非常短，不易察觉
+ 每个进程收到的所有信号，都是由内核负责发送，内核处理
+ 递达：递送切到达进程
+ 未决：产生和递达之间的状态。主要由于阻塞（屏蔽）导致该状态
+ 信号的4要素：1.编号，2.名称，3.事件，4.默认处理动作
+ 只有每个信号对应的事件发生了，该信号才能被发送，不应该乱发信号
+ read阻塞时，信号中断系统调用：1.返回部分读到的数据，2.read调用失败，errno设成EINTER

# 信号产生种类

+ 终端特殊按键：ctl+c SIGINT，ctl+z SIGTSTP，ctl+\ SIGQUIT
+ 硬件异常：非法访问内存（段错误），除0（浮点数除外），内存对齐出错（总线错误）
+ 系统调用：kill，raise，abort
+ 软件条件产生：alarm（定时器）
+ 命令产生：kill

# 信号处理方式：

1. 执行默认动作：默认动作有五种：

   > 1. Term表示终止当前进程.
   > 2. Core表示终止当前进程并且Core Dump（Core Dump 用于gdb调试）
   > 3. Ign表示忽略该信号
   > 4. Stop表示停止当前进程
   > 5. Cont表示继续执行先前停止的进程

2. 捕捉（调用用户处理函数）
3. 忽略（不处理）

+ **注意：9号信号（SIGKILL）和19号信号（SIGSTOP），不允许忽略和捕捉，只能执行默认动作，甚至不能将其设置为阻塞。**

# 集合

+ 每个进程中的PCB中都有两个信号集合（阻塞信号集和未决信号集）
+ 阻塞信号集（信号屏蔽字）：将某些信号加入集合，对他们设置屏蔽，当屏蔽该信号后，再收到该信号，该信号的处理会被阻塞，直到解除屏蔽
+ 未决信号集：信号产生后由于某些原因未被处理。这些信号的集合称为未决信号集。在屏蔽解除之前，信号一直处理未决状态。
+ **注意：子进程继承了父进程的阻塞信号集和信号处理动作，但是不继承未决信号集**
+ 前32个信号不支持排队，如果一个信号处于未决态时，该信号再触发一次则该信号不会被响应
+ 那么当信号X触发时，信号X会被设置为未决态（未决信号集中的值设为1）
  + 当阻塞信号集中信号X被设置为阻塞（阻塞信号集中的值为1），那么该信号X会被阻塞不会被处理
  + 没有被阻塞，那么该信号X会执行处理动作（忽略，默认动作，捕捉）

> 未决信号集和阻塞信号集：![决信号集和阻塞信号集](https://github.com/594301947/knowledge/blob/master/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E8%BF%9B%E7%A8%8B/images/%E6%9C%AA%E5%86%B3%E4%BF%A1%E5%8F%B7%E9%9B%86%E5%92%8C%E9%98%BB%E5%A1%9E%E4%BF%A1%E5%8F%B7%E9%9B%86.png)

# 信号产生原因

+ 1) SIGHUP:当用户退出shell时，由该shell启动的所有进程将收到这个信号，默认动作为终止进程
+ 2）SIGINT：当用户按下了<Ctrl+C>组合键时，用户终端向正在运行中的由该终端启动的程序发出此信号。默认动
  作为终止里程。
+ 3）SIGQUIT：当用户按下<ctrl+\>组合键时产生该信号，用户终端向正在运行中的由该终端启动的程序发出些信号。默认动作为终止进程。
+ 4）SIGILL：CPU检测到某进程执行了非法指令。默认动作为终止进程并产生core文件
+ 5）SIGTRAP：该信号由断点指令或其他 trap指令产生。默认动作为终止里程 并产生core文件。
+ 6 ) SIGABRT:调用abort函数时产生该信号。默认动作为终止进程并产生core文件。
+ 7）SIGBUS：非法访问内存地址，包括内存对齐出错，默认动作为终止进程并产生core文件。
+ 8）SIGFPE：在发生致命的运算错误时发出。不仅包括浮点运算错误，还包括溢出及除数为0等所有的算法错误。默认动作为终止进程并产生core文件。
+ 9）SIGKILL：无条件终止进程。本信号不能被忽略，处理和阻塞。默认动作为终止进程。它向系统管理员提供了可以杀死任何进程的方法。
+ 10）SIGUSE1：用户定义 的信号。即程序员可以在程序中定义并使用该信号。默认动作为终止进程。
+ 11）SIGSEGV：指示进程进行了无效内存访问。默认动作为终止进程并产生core文件。
+ 12）SIGUSR2：这是另外一个用户自定义信号 ，程序员可以在程序中定义 并使用该信号。默认动作为终止进程。
+ 13）SIGPIPE：Broken pipe向一个没有读端的管道写数据。默认动作为终止进程。
+ 14) SIGALRM:定时器超时，超时的时间 由系统调用alarm设置。默认动作为终止进程。
+ 15）SIGTERM：程序结束信号，与SIGKILL不同的是，该信号可以被阻塞和终止。通常用来要示程序正常退出。执行shell命令Kill时，缺省产生这个信号。默认动作为终止进程。
+ 16）SIGCHLD：子进程结束时，父进程会收到这个信号。默认动作为忽略这个信号。
+ 17）SIGCONT：停止进程的执行。信号不能被忽略，处理和阻塞。默认动作为终止进程。
+ 18）SIGTTIN：后台进程读终端控制台。默认动作为暂停进程。
+ 19）SIGTSTP：停止进程的运行。按下<ctrl+z>组合键时发出这个信号。默认动作为暂停进程。
+ 21）SIGTTOU:该信号类似于SIGTTIN，在后台进程要向终端输出数据时发生。默认动作为暂停进程。
+ 22）SIGURG：套接字上有紧急数据时，向当前正在运行的进程发出些信号，报告有紧急数据到达。如网络带外数据到达，默认动作为忽略该信号。
+ 23）SIGXFSZ：进程执行时间超过了分配给该进程的CPU时间 ，系统产生该信号并发送给该进程。默认动作为终止进程。
+ 24）SIGXFSZ：超过文件的最大长度设置。默认动作为终止进程。
+ 25）SIGVTALRM：虚拟时钟超时时产生该信号。类似于SIGALRM，但是该信号只计算该进程占用CPU的使用时间。默认动作为终止进程。
+ 26）SGIPROF：类似于SIGVTALRM，它不公包括该进程占用CPU时间还包括执行系统调用时间。默认动作为终止进程。
+ 27）SIGWINCH：窗口变化大小时发出。默认动作为忽略该信号。
+ 28）SIGIO：此信号向进程指示发出了一个异步IO事件。默认动作为忽略。
+ 29）SIGPWR：关机。默认动作为终止进程。
+ 30）SIGSYS：无效的系统调用。默认动作为终止进程并产生core文件。
+ 31）SIGRTMIN～（64）SIGRTMAX：LINUX的实时信号，它们没有固定的含义（可以由用户自定义）。所有的实时信号的默认动作都为终止进程。