# 如何在40亿数据中找到最多出现的一个数

### 问题：

在1G的内存中，查找40亿的无符号整数中如何找到出现次数最多的一个数

### 常规思想：

用一个hashmap保存每个数出现的情况<key,cnt>。这样就知道每个数出现的次数。

但是上面的思路是有问题的：因为hashmap保存的key和value，分别是4个字节。那一对数据就要8个字节。在40亿数据中，最坏的情况没有重复的情况，那么需要的内存就是：40亿*8字节=32G。

**32G已经超过我们限定的最大内存，所以这个思路不行**

### 解法思路：

通过上面的思路，我们可以得知hashmap占用内存大小：只跟不同元素个数有关，跟相同元素出现多少次无关。

所以我们通过以下方法解决：

1. 对每个数都进行hash函数，会得到对应的hash值。（相同数通过相同hash函数得到的hash值一定一样）
2. 然后对上面的hash值对100取模，得到这个hash值取模后的范围在0~99之间。
3. 上面得到取模后的结果0~99，然后将这个数放到对应的0~99文件中（会存在不同hash值取模后数值一样）
4. 那么40亿的数据就会均分在0~99的文件内。最坏情况一个文件里面的数字都不一样，然后全部加载到内存后大概需要的内存是：40亿/100*8字节=0.32G。最坏情况需要的内存大小没超过1G
5. 将1个文件的数据全部加载到内存，然后存到hashmap中。这样就知道这个文件每个数出现次数的情况。从而得到这个文件出现最大的数值MaxVal1
6. 0~99个文件依次执行步骤5，可以得到这个100个文件的最多次数的数值（MaxVal1~MaxVal100）。然后再对这100个数值做比较就知道最多出现的次数了。