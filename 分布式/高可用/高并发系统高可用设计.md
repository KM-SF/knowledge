### 什么是高可用

互联网应用是面向大众的应用系统，他们可能会随时会被使用，那么应用就必须要保持随时可用，也就是我们常说的7x24小时可用，但是互联网应用有可能会遇到硬件故障，软件故障等多种问题，可能导致服务的不可用，所以要想保证服务100%可用是一件几乎不可能实现的事情。所以业界通常用多少个9来说明互联网应用的可用性，比如说某宝的可用性4个9,4个9是说服务可用性是99.99%可用，也就是说某宝的服务可以实现在运行时间内只有0.01%不可用，换句话说，当遇到上述的故障后，可在0.01%的时间内解决。如果以年为运行时间单位的化，那么不可用时间就是53分钟(3652460*0.01%)不同应用的可用性差别主要就体现在面对各种故障时，高可用设计做的是否足够好。

**目前系统架构设计方面常用的高可用设计方案主要有以下几种：解耦，隔离，异步，备份，重试，熔断，补偿，降级，限流，多活等**

### 解耦

系统耦合度过高时软件设计的万恶之源，也是造成系统可用性的罪魁祸首，以为一个高度耦合的系统，牵一发动全身，任何微小的改动都可能导致意想不到的bug和系统崩溃，连最基本的功能维护都很吃力，更别提什么高可用了。

### 隔离

如果说解耦是逻辑上的分割，那么隔离就是物理上的分割。即将低耦合的组件进行独立部署，将不同组件在物理上隔离开来。每个组件有自己独立的代码仓库；每个组件可以独立发布，互不影响；每个组件有自己独立的容器进行部署，互不干扰。所以，隔离就是分布式技术在业务上的应用，最常见的就是我们前面案例中也多次使用的微服务技术方案

### 异步

异步可以认为是在隔离的基础上进一步解耦，将物理上已经分割的组件之间的依赖关系进一步切断，使故障无法扩散，提高系统可用性。异步在架构上的实现手段主要是使用消息队列，降低非核心服务故障导致业务不可用

### 备份

备份冗余，是解决高可用的最基本的手段，即一个服务部署在多个服务器上，一份数据冗余备份多份，当一个服务出现故障或者一份数据丢失，还有其他服务可以提供，还有其他数据提供支持。但是这里有一个比较重要的机制，就是故障转移，也就是，能够感知到服务故障，数据丢失后，将请求转发到其他服务上，访问访问其他数据。
常用的故障转移的手段是负载均衡，其实负载均衡不仅可以实现高可用，还是实现呢高性能的主要手段。在一个多备份的服务集群中，当一个服务出现故障后，通过负载均衡，可以将请求转移到其他健康的服务上。

### 多活

多活，即异地多活，在多个地区建立数据中心，并都可以对用户提供服务，任何地区级的灾难都不会影响系统的可用

### 重试

远程服务可能会由于线程阻塞、[垃圾回收](https://so.csdn.net/so/search?q=垃圾回收&spm=1001.2101.3001.7020)或者网络抖动，而无法及时返回响应，调用者可以通过重试的方式修复单次调用的故障。需要注意的是，重试是有风险的，要保证幂等性。

### 熔断

重试主要解决偶发的因素导致的单次调用失败，但是如果某个服务器一直不稳定，甚至已经宕机，再请求这个服务器或者进行重试都没有意义了。所以为了保证系统整体的高可用，对于不稳定或者宕机的服务器需要进行熔断。熔断更多的是保护上游服务的可用性。
熔断的主要方式是使用断路器阻断对故障服务器的调用

### 补偿

前面几种方案都是故障发生时如何处理，而补偿则是故障发生后，如何弥补错误或者避免损失扩大

### 限流

在高并发场景下，如果系统的访问量超过了系统的承受能力，可以通过限流对系统进行保护。限流是指对进入系统的用户请求进行流量限制，如果访问量超过了系统的最大处理能力，就会丢弃一部分用户请求，保证整个系统可用。这样虽然有一部分用户的请求被丢弃，但大部分用户还是可以访问系统的，总比整个系统崩溃，所有的用户都不可用要好。

### 降级

降级是保护系统高可用的另一种手段。有一些系统功能是非核心的，但是也给系统产生了非常大的压力。在系统压力过大的时候，将一些非核心功能关闭，也是对系统资源保护。



### 参考

------

原文链接：https://blog.csdn.net/weixin_45701550/article/details/124515703
原文链接：https://blog.csdn.net/weixin_45701550/article/details/124366649