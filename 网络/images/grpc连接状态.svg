<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="459px" preserveAspectRatio="none" style="width:527px;height:459px;background:#FFFFFF;" version="1.1" viewBox="0 0 527 459" width="527px" zoomAndPan="magnify"><defs><filter height="300%" id="f1mwi4tijwnoo2" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="211.38" cy="27" fill="#000000" filter="url(#f1mwi4tijwnoo2)" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f1mwi4tijwnoo2)" height="40" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="50" x="116.38" y="7"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="126.38" y="33.4839">IDLE</text><rect fill="#FEFECE" filter="url(#f1mwi4tijwnoo2)" height="40" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="100" x="91.38" y="224"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90" x="96.38" y="250.4839">CONNECTING</text><rect fill="#FEFECE" filter="url(#f1mwi4tijwnoo2)" height="40" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="57" x="269.88" y="224"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="274.88" y="250.4839">READY</text><rect fill="#FEFECE" filter="url(#f1mwi4tijwnoo2)" height="40" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="151" x="72.88" y="405"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141" x="77.88" y="431.4839">TRANSIENT_FAILURE</text><rect fill="#FEFECE" filter="url(#f1mwi4tijwnoo2)" height="40" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="66" x="259.38" y="405"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="264.38" y="431.4839">任意状态</text><rect fill="#FEFECE" filter="url(#f1mwi4tijwnoo2)" height="40" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="89" x="424.88" y="405"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="429.88" y="431.4839">SHUTDOWN</text><!--MD5=[0f992647b4900e7307cd0f7e2f3b8386]
reverse link IDLE to *start--><path d="M171.69,27 C181.53,27 191.38,27 201.22,27 " fill="none" id="IDLE-backto-*start" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="166.54,27,175.54,31,171.54,27,175.54,23,166.54,27" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[5197ad15de736a8bda94f5d260633e30]
link IDLE to CONNECTING--><path d="M116.05,37.91 C89.19,49.96 48.24,73.11 30.38,108 C19.24,129.76 19.24,141.24 30.38,163 C43.58,188.77 69.36,208.13 92.77,221.35 " fill="none" id="IDLE-to-CONNECTING" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="97.41,223.91,91.4655,216.0574,93.0332,221.4927,87.5979,223.0604,97.41,223.91" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="31.38" y="141.8979">有RPC调用</text><!--MD5=[b37ed21cb1a632d05efaddeac17d0713]
reverse link IDLE to CONNECTING--><path d="M141.38,52.1 C141.38,95.24 141.38,184.79 141.38,223.96 " fill="none" id="IDLE-backto-CONNECTING" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="141.38,47.08,137.38,56.08,141.38,52.08,145.38,56.08,141.38,47.08" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="142.38" y="141.8979">IDLE_TIMEOUT</text><!--MD5=[9e0e4f99ede94440d0d92e11b9cab2da]
link CONNECTING to READY--><path d="M191.67,244 C215.93,244 240.19,244 264.44,244 " fill="none" id="CONNECTING-to-READY" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="269.62,244,260.62,240,264.62,244,260.62,248,269.62,244" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[0e3676390a90219d82f6e8cfacf57a63]
link READY to IDLE--><path d="M293.66,223.54 C286.23,195.8 269.76,144.24 242.38,108 C222.91,82.23 193.28,60.08 171.14,45.67 " fill="none" id="READY-to-IDLE" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="166.82,42.89,172.2403,51.1132,171.0301,45.5873,176.5559,44.3771,166.82,42.89" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="273.38" y="123.8979">IDLE_TIMEOUT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="13" x="312.38" y="141.6523">或</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="285.38" y="159.4067">GO_AWAY</text><!--MD5=[6976270180b22ae2801cf66b4691f002]
link READY to READY--><path d="M327.12,235.29 C344.93,233.19 361.88,236.09 361.88,244 C361.88,251.11 348.2,254.17 332.5,253.2 " fill="none" id="READY-to-READY" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="327.12,252.71,335.7308,257.4906,332.1004,253.1524,336.4386,249.522,327.12,252.71" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="367.88" y="250.3979">持续有RPC</text><!--MD5=[e8e498fb71894958ab3e0308febf6f4e]
link READY to TRANSIENT_FAILURE--><path d="M287.38,264.12 C275.13,284.73 254.18,318.07 232.38,344 C214.8,364.93 192.24,386.15 174.94,401.48 " fill="none" id="READY-to-TRANSIENT_FAILURE" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="171.1,404.85,180.5017,401.9161,174.8567,401.5504,175.2224,395.9054,171.1,404.85" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="247.38" y="340.8979">通信失败</text><!--MD5=[94f408bad4ac8db73a2b975eccd0ac65]
link CONNECTING to TRANSIENT_FAILURE--><path d="M91.17,262.72 C51.57,279.8 6,308.28 25.38,344 C39.79,370.56 67.25,389.68 92.58,402.56 " fill="none" id="CONNECTING-to-TRANSIENT_FAILURE" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="97.28,404.89,90.9899,397.3115,92.7993,402.6711,87.4397,404.4806,97.28,404.89" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="26.38" y="340.8979">建立连接失败</text><!--MD5=[77414fdb3d8ccd869f55be89914b66c5]
link TRANSIENT_FAILURE to CONNECTING--><path d="M147.64,404.98 C146.36,372.24 143.74,305.28 142.33,269.24 " fill="none" id="TRANSIENT_FAILURE-to-CONNECTING" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="142.13,264.16,138.4929,273.3127,142.3298,269.156,146.4865,272.9929,142.13,264.16" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="145.38" y="340.8979">达到重连超时</text><!--MD5=[cf68a2ebba65ac196e5fd814ce4ef5bd]
link ALL_STATE to SHUTDOWN--><path d="M325.68,425 C352.18,425 389.69,425 419.74,425 " fill="none" id="ALL_STATE-to-SHUTDOWN" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="424.88,425,415.88,421,419.88,425,415.88,429,424.88,425" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="349.13" y="400.8979">应用触发</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="343.63" y="418.6523">shutdown()</text><!--MD5=[a9ed6676a10af669dae7b778c267b6e2]
link TRANSIENT_FAILURE to ALL_STATE--><!--MD5=[a4e1704edb0b62ae5ebc5c135fa621f0]
@startuml
hide empty description

 [*] - -left-> IDLE

IDLE - -right-> CONNECTING : 有RPC调用
CONNECTING -up-> IDLE : IDLE_TIMEOUT

CONNECTING - -right-> READY


READY - - -> IDLE :IDLE_TIMEOUT\n或\nGO_AWAY
READY - - -> READY : 持续有RPC

READY - -down-> TRANSIENT_FAILURE : 通信失败
CONNECTING -> TRANSIENT_FAILURE : 建立连接失败
TRANSIENT_FAILURE -> CONNECTING : 达到重连超时

state "任意状态" as ALL_STATE
ALL_STATE - -right-> SHUTDOWN : 应用触发\nshutdown()

TRANSIENT_FAILURE -right[hidden]-> ALL_STATE


@enduml

PlantUML version 1.2021.7(Sun May 23 20:40:07 CST 2021)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg>